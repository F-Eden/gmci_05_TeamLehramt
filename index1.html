<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Course Feedback</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: auto; padding: 1em; }
    label { display: block; margin: 1em 0 0.5em; }
    textarea, select, input[type=submit] { width: 100%; padding: 0.5em; font-size: 1em; }
    #message { margin-top: 1em; font-weight: bold; }
  </style>
</head>
<body>
  <h1>Feedback f√ºr die Vorlesung</h1>

  <form id="feedbackForm">
    <label for="rating">Wie bewertest du die Vorlesung? (1 = schlecht, 5 = sehr gut)</label>
    <select id="rating" name="rating" required>
      <option value="">Bitte w√§hlen</option>
      <option value="1">1 - schlecht</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 - sehr gut</option>
    </select>

    <label for="mood">Wie war deine Stimmung heute? (Emoji)</label>
    <select id="mood" name="mood" required>
      <option value="">Bitte w√§hlen</option>
      <option value="üòÄ">üòÄ Gut</option>
      <option value="üòê">üòê Neutral</option>
      <option value="üòû">üòû Schlecht</option>
    </select>

    <label for="comment">M√∂chtest du noch etwas mitteilen?</label>
    <textarea id="comment" name="comment" rows="4" placeholder="Dein Kommentar (optional)"></textarea>

    <input type="submit" value="Feedback absenden" />
  </form>

  <div id="message"></div>

  <script>
    const feedbackForm = document.getElementById('feedbackForm');
    const messageDiv = document.getElementById('message');

    feedbackForm.addEventListener('submit', async function (event) {
      event.preventDefault();

      const rating = document.getElementById('rating').value;
      const mood = document.getElementById('mood').value;
      const comment = document.getElementById('comment').value;

      // Neues Feedback-Dokument
      const feedbackDoc = {
        type: 'feedback',
        timestamp: new Date().toISOString(),
        rating: rating,
        mood: mood,
        comment: comment
      };

      try {
        // CouchDB URL: Ersetze 'admin:password@localhost:5984' ggf. mit deinen Zugangsdaten
        const response = await fetch('http://admin:password@localhost:5984/course_feedback', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(feedbackDoc)
        });

        if (response.ok) {
          messageDiv.textContent = 'Danke f√ºr dein Feedback!';
          feedbackForm.reset();
        } else {
          const errorData = await response.json();
          messageDiv.textContent = 'Fehler beim Speichern: ' + (errorData.reason || response.statusText);
        }
      } catch (error) {
        messageDiv.textContent = 'Verbindungsfehler: ' + error.message;
      }
    });
  </script>
</body>
</html>